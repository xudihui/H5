<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>JSBridge</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
  </head>
  <body>
    <section class="page-header">
	    <a class="btn">设置标题SPA</a>
      <a class="btn">分享</a>
      <a class="btn">进入APP登录</a>
      <a class="btn">获取App用户信息</a>
      <a class="btn">获取App版本信息</a>

    </section>

    <section class="main-content">

      <h3 id="here-is-an-unordered-list">web调用App:</h3>
      <table>
       <thead>
        <tr>
          <td>名称</td>
          <td>示例</td>  
        </tr>  
       </thead>    
        <tr>
          <td>设置标题</td>
          <td>
            <pre>
jsBridge.setTitle(title);
//title 标题名称
            </pre>       
          </td>   
        </tr>
        <tr>
          <td>分享</td>
          <td><pre>
jsBridge.setShareInfo({
   title:'分享标题',
   content:'分享正文',
   imageUrl:'图片地址',
   shareUrl:'链接地址'
 })</pre></td>    
        </tr> 
        <tr>
          <td>进入APP功能页</td>
          <td>
            <pre>
jsBridge.gotoNative(pageName);
//pageName：登录/注册/退出等
            </pre>       
          </td>    
        </tr>           
      </table>

    
      <h3 id="here-is-an-unordered-list">App调用web定义的方法(必须暴露在全局)</h3>
      <table>
       <thead>
        <tr>
          <td>方法名</td>
          <td>示例</td>  
        </tr>  
       </thead>    
        <tr>
          <td>分享结果</td>
          <td>getMessageFromApp</td>  
        </tr>
        <tr>
          <td>用户信息传递</td>
          <td>getDataFromApp</td>    
        </tr>          
      </table>
    
      <h3 id="here-is-an-unordered-list">URL拦截</h3>
      <table>
       <thead>
        <tr>
          <td>方法名</td>
          <td>拦截地址格式</td>  
        </tr>  
       </thead>    
        <tr>
          <td>设置标题</td>
          <td>"smkapp://setTitle/{TITLE}"</td>  
        </tr>
        <tr>
          <td>分享</td>
          <td>"smkshare:{"shareUrl":"{lineLink}","title":"{shareTitle}","content":"{descContent}","imageUrl":"{imgUrl}"}"</td>    
        </tr> 
        <tr>
          <td>进入APP功能页</td>
          <td>"smknative:open{PAGE}"</td>    
        </tr>           
      </table>      
</section>
<script type="text/javascript">

  var $ = function(el){
        return document.querySelectorAll(el)
  }
  var btns = $('.btn');
  btns[0].onclick = function(){
     var title = prompt('请输入新title名','hello Word!');
     if(title){
        jsBridge.setTitle(title)
     }
  }
  btns[1].onclick = function(){
     jsBridge.setShareInfo({
       title:'分享标题',
       content:'分享正文',
       imageUrl:'图片地址',
       shareUrl:'https://www.96225.com'
     })
  }
  btns[2].onclick = function(){
     jsBridge.gotoNative('LoginView');
  } 

  btns[4].onclick = function(){
    var self = this;
    appendP(self,navigator.userAgent);
  } 

//动态插入P标签
var appendP = function(father,child){
  var p = document.createElement("p");
  p.innerHTML = child;  
  father.appendChild(p);
  setTimeout(function(){
    father.removeChild(p);
  },10000)
}


//分享回调 
var getMessageFromApp = function(dataStr){
    // 这里app传过来的必须是字符串，转换成json {"shareStatus":"1"}
    try{
       var data = JSON.parse(dataStr);
        // 分享成功
        if(data['shareStatus'] == 1){
          alert('success')
        }
        else{
          alert('fail')
        }       
    }
    catch(e){
        alert(e.message.indexOf('Unexpected ') > -1 ? '分享出错' : null)
    }
}  

//从app获取用户信息
var getDataFromApp = function(data) {
    btns[3].onclick = function(){
     var self = this;
     appendP(self,data);
    }     
    var o = JSON.parse(data);
}

</script>
  
  </body>
</html>
