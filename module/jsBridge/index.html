<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>JSBridge</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <script type='text/javascript' src='jsBridge.js'></script>
  </head>
  <body>
    <section class="page-header">
	    <a class="btn">设置标题SPA</a>
      <a class="btn">分享</a>
      <a class="btn">进入APP登录</a>
      <a class="btn">获取App用户信息</a>
      <a class="btn">获取App版本信息</a>
      <a class="btn" href='https://cnodejs.org/setting'>跳出去</a>      
      <a class="btn">获取用户token</a>

    </section>

    <section class="main-content">

      <h3 id="here-is-an-unordered-list">web调用App:</h3>
      <table>
       <thead>
        <tr>
          <td>名称</td>
          <td>示例</td>  
        </tr>  
       </thead>    
        <tr>
          <td>设置标题</td>
          <td>
            <pre>
jsBridge.setTitle(title);
//title 标题名称
            </pre>       
          </td>   
        </tr>
        <tr>
          <td>分享</td>
          <td><pre>
jsBridge.setShareInfo({
   title:'分享标题(String)',
   content:'分享正文(String)',
   imageUrl:'图片地址(String)',
   shareUrl:'链接地址(String)',
   success:'分享成功(Function [appVersion])',
   error:'分享取消或者失败(Function [appVersion])'
 })
 //所有字段必填*
 </pre></td>    
        </tr> 
        <tr>
          <td>进入APP功能页</td>
          <td>
            <pre>
jsBridge.gotoNative(pageName);
//pageName：登录/注册/退出等
            </pre>       
          </td>    
        </tr>           
      </table>

    
      <h3 id="here-is-an-unordered-list">App调用web定义的方法(必须暴露在全局)</h3>
      <table>
       <thead>
        <tr>
          <td>方法名</td>
          <td>示例</td>  
        </tr>  
       </thead>    
        <tr>
          <td>分享结果</td>
          <td>getMessageFromApp</td>  
        </tr>
        <tr>
          <td>用户信息传递</td>
          <td>getDataFromApp</td>    
        </tr>          
      </table>
    
      <h3 id="here-is-an-unordered-list">URL拦截</h3>
      <table>
       <thead>
        <tr>
          <td>方法名</td>
          <td>拦截地址格式</td>  
        </tr>  
       </thead>    
        <tr>
          <td>设置标题</td>
          <td>"smkapp://setTitle/{TITLE}"</td>  
        </tr>
        <tr>
          <td>分享</td>
          <td>"smkshare:{"shareUrl":"{lineLink}","title":"{shareTitle}","content":"{descContent}","imageUrl":"{imgUrl}"}"</td>    
        </tr> 
        <tr>
          <td>进入APP功能页</td>
          <td>"smknative:open{PAGE}"</td>    
        </tr>           
      </table>   


<h3 id="here-is-an-unordered-list">代码贡献</h3>
<ul>
  <li>欢迎大家通过<a href="https://github.com/xudihui/H5/issues" > issue </a>反馈使用问题</li>
  <li><a href="https://github.com/xudihui/H5/pulls" > pulls </a>贡献您的代码！</li>
</ul>         
</section>
<script type="text/javascript">

  var $ = function(el){
        return document.querySelectorAll(el)
  }
  var btns = $('.btn');
  btns[0].onclick = function(){
     var title = prompt('请输入新title名','hello Word!');
     if(title){
        jsBridge.setTitle(title)
     }
  }
  btns[1].onclick = function(){
     jsBridge.setShareInfo({
       title:'分享标题%%%',
       content:'分享正文%%%',
       imageUrl:'http://activity.96225.com/exthtml/asevenf/img/Forward.jpg',
       shareUrl:'https://www.96225.com',
       success:function(v){alert('成功'+v)},
       error:function(v){alert('失败'+v)}
     })
  }
  btns[2].onclick = function(){
     jsBridge.gotoNative('LoginView');
  } 

  btns[4].onclick = function(){
    var self = this;
    appendP(self,navigator.userAgent);
  } 
  btns[6].onclick = function(){
      jsBridge.getToken(function(i){alert('用户Token:'+i)});
  }   

//动态插入P标签
var appendP = function(father,child){
  var p = document.createElement("p");
  p.innerHTML = child;  
  father.appendChild(p);
  setTimeout(function(){
    father.removeChild(p);
  },10000)
}


//从app获取用户信息
var getDataFromApp = function(data) {
  alert('执行')
    btns[3].onclick = function(){
     var self = this;
     appendP(self,data);
    }     
    var o = JSON.parse(data);
}

</script>
  
  </body>
</html>
